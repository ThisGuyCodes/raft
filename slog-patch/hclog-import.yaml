rules:
- id: hclog-import-named
  pattern: import hclog "github.com/hashicorp/go-hclog"
  fix-regex:
    regex: 'hclog "github.com/hashicorp/go-hclog"'
    replacement: 'hclog "log/slog"'
  message: use of hclog
  languages: [go]
  severity: WARNING
- id: hclog-import-unnamed
  pattern: import "github.com/hashicorp/go-hclog"
  fix-regex:
    regex: '"github.com/hashicorp/go-hclog"'
    replacement: 'hclog "log/slog"'
  message: use of hclog
  languages: [go]
  severity: WARNING
- id: hclog-logger-arg
  pattern: |
    func $FUNC(..., $NAME hclog.Logger, ...) {...}
  fix-regex:
    regex: hclog.Logger
    replacement: '*hclog.Logger'
  message: use of hclog.Logger as a func arg
  languages: [go]
  severity: WARNING
- id: hclog-logger-return
  pattern: |
    func $FUNC(...) hclog.Logger {...}
  fix-regex:
    regex: hclog.Logger
    replacement: '*hclog.Logger'
  message: use of hclog.Logger as a func arg
  languages: [go]
  severity: WARNING
- id: hclog-logger-struct-member
  pattern: |
    type $STRUCT struct {
      $NAME hclog.Logger
    }
  fix-regex:
    regex: hclog.Logger
    replacement: '*hclog.Logger'
  message: use of hclog.Logger as a func arg
  languages: [go]
  severity: WARNING
- id: hclog-getorcreatelogger
  pattern: |
    func getOrCreateLogger(...) {
      ...
    }
  fix: ""
  message: remove getOrCreateLogger method
  languages: [go]
  severity: WARNING
- id: hclog-getorcreatelogger-use
  pattern: |
    $RECV.getOrCreateLogger()
  fix: $RECV.Logger
  message: remove getOrCreateLogger use
  languages: [go]
  severity: WARNING
